diff -u -r IO-Compress-Brotli-0.019.orig/Makefile.PL IO-Compress-Brotli-0.019/Makefile.PL
--- IO-Compress-Brotli-0.019.orig/Makefile.PL	2025-05-09 16:56:26.163965258 +0200
+++ IO-Compress-Brotli-0.019/Makefile.PL	2025-05-09 17:15:04.015620812 +0200
@@ -1,24 +1,24 @@
 use 5.008000;
 use ExtUtils::MakeMaker;
-use Alien::cmake3;
-use File::Spec::Functions qw/catfile/;
-use Config;
+use ExtUtils::PkgConfig;
 
-my $cmake_options;
-my $myextlib = 'brotli/libbrotlienc$(LIB_EXT) brotli/libbrotlidec$(LIB_EXT) brotli/libbrotlicommon$(LIB_EXT)';
+my @requirements = qw(libbrotlidec libbrotlienc);
+my $libs = '';
+my $inc  = '';
 
-if ($Config{myuname} =~ /strawberry/i || $Config{osname} =~ /MSWin/i ) {
-    if ($Config{cc} =~ /gcc/i) {
-        $cmake_options = ' -G "MinGW Makefiles" ';
-    } elsif ($Config{cc} =~ /cl/i) {
-        $cmake_options = ' -G "NMake Makefiles" ';
-        $myextlib = 'brotli/libbrotlienc$(LIB_EXT) brotli/libbrotlidec$(LIB_EXT) brotli/libbrotlicommon$(LIB_EXT)';
-    } else {
-        $cmake_options = '';
-        $myextlib = 'brotli/libbrotlienc$(LIB_EXT) brotli/libbrotlidec$(LIB_EXT) brotli/libbrotlicommon$(LIB_EXT)';
-    }
+my %pkgcfg;
+foreach my $req (@requirements) {
+	eval{
+		%pkgcfg = ExtUtils::PkgConfig->find($req);
+	};
+	if ($@) {
+		die "Could not determine location of library $req.";
+	}
+	$libs .= $pkgcfg{libs}.' ';
+	$inc  .= $pkgcfg{cflags}.' ';
 }
 
+
 WriteMakefile(
 	NAME             => 'IO::Compress::Brotli',
 	VERSION_FROM     => 'lib/IO/Compress/Brotli.pm',
@@ -33,29 +33,12 @@
 		'Getopt::Long'  => '0',
 		'Time::HiRes'   => '0',
 	},
-	CONFIGURE_REQUIRES   => {
-		'Alien::cmake3' => '0',
-	},
-	BUILD_REQUIRES   => {
-		'Alien::cmake3' => '0',
-	},
-	INC              => '-Ibrotli/c/include',
-	MYEXTLIB         => $myextlib,
-	EXTRALIBS        => ' brotli/libbrotlienc$(LIB_EXT) brotli/libbrotlidec$(LIB_EXT) brotli/libbrotlicommon$(LIB_EXT) ',
-	clean            => { FILES => "brotli/Makefile $myextlib brotli/CMakeCache.txt brotli/CMakeFiles/* brotli/CTestTestfile.cmake brotli/DartConfiguration.tcl brotli/brotli* brotli/cmake_install.cmake brotli/libbrotlicommon.pc brotli/libbrotlidec.pc brotli/libbrotlienc.pc" },
 	META_ADD         => {
 		dynamic_config => 0,
 		resources      => {
 			repository   => 'https://github.com/timlegge/perl-IO-Compress-Brotli',
 		},
-	}
+	},
+	LIBS            => $libs,
+	INC             => $inc,
 );
-
-sub MY::postamble {
-    my @dirs = Alien::cmake3->bin_dir;
-    my $cmake = defined $dirs[0] ? catfile($dirs[0] , Alien::cmake3->exe) : Alien::cmake3->exe;
-'
-$(MYEXTLIB): brotli/CMakeLists.txt
-	cd brotli && "' . $cmake . '"' . $cmake_options . ' -DCMAKE_MAKE_PROGRAM=$(MAKE) -DBUILD_SHARED_LIBS=OFF -DCMAKE_POSITION_INDEPENDENT_CODE=ON -DCMAKE_BUILD_TYPE=Release -DCMAKE_INSTALL_PREFIX=./installed . && $(MAKE)
-'
-}
